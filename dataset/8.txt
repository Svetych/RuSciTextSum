О конечных автоматах с максимальной степенью различимости состояний

Математической моделью большинства устройств обработки цифровой информации - последовательностных устройств - являются конечные автоматы. Одним из параметров конечного автомата является его степень различимости. Этот параметр влияет на длину диагностического и установочного экспериментов для автоматов с известным поведением, а также на длину расшифровки «черных ящиков» (автоматов с неизвестными функциями выхода и переходов). В первом случае желательны автоматы с малой степенью различимости. При создании криптостойких конечно автоматных систем шифрования желательны автоматы с высокой степенью различимости.
Известно [1], что степень различимости может быть очень высокой, равной s - 1, где s - число состояний. С другой стороны доказано [2], что почти все автоматы имеют степень различимости logm logn s, где n (m) - мощность входного (выходного) алфавита.
В работе рассматриваются множества конечных автоматов с произвольными функциями выхода и переходов.
Состояния конечного автомата называются r-эквивалентными, если соответствующие им автоматные функции одинаковы на словах длины r. Состояния называются r-различимыми, если они (r1)эквивалентны и соответствующие им автоматные функции различаются на словах длины r. Максимальная степень различимости состояний автомата называется его степенью различимости. При отсутствии ограничений известна достижимая верхняя оценка степени различимости равная s - 1, где s - число состояний автомата. В каждом своем состоянии конечный автомат реализует функцию, аргументы которой (значения которой) суть элементы входного (выходного) алфавита. Число различных таких функций будем называть статической функциональностью автомата. Рассматриваются автоматы с заданной статической функциональностью. Получена достижимая верхняя оценка степени различимости, равная s + 1 - F , где F - статическая функциональность автомата.
Множество {s1 , s2 , . . . , sF }, где si , 1 <= i <= F, - мощность i-го класса 1-эквивалентности будем называть спектром конечного автомата. Показана зависимость максимальной степени различимости состояний конечного автомата от его спектра.   
Конечный автомат является имеющим вход и выход устройством, которое в каждый момент времени находится в одном из своих состояний. Конечный автомат осуществляет преобразование информации в дискретные моменты времени. На вход автомата поступает последовательность символов входного алфавита X = (x1 , x2 , . . . , xn ); эту последовательность называют входным словом. В каждый момент времени конечный автомат находится в одном из своих s(внутренних) состояний, образующих множество Q = {q1 , q2 . . . , qs } (алфавит состояний). В каждый момент времени значением выхода автомата является элемент выходного алфавита Y = {y1 , y2 , . . . , ym }. В работе, в основном, будет использовано задание (описание) функционирования конечного автомата системой его ns команд. Каждая команда имеет вид xi qj -> yk qr , где xi - входная буква, qj - состояние, yk - выходная буква и qr - состояние в следующий за текущим моментом момент времени (следующее состояние).
Функционирование конечного автомата задают также кортежем hX, Y, Q, V, P i, где V : X * Q -> Y (функция выхода), P : X * Q -> Q (функция переходов).
Конечный автомат с фиксированным состоянием в начальный момент времени называется инициальным автоматом. В соответствии со своей системой команд инициальный автомат реализует автоматную функцию, которая произвольное входное слово в алфавите X преобразует в выходное слово в алфавите Y той же длины.
Состоянию qi конечного автомата M поставим в соответствие автоматную функцию Mi , реализуемую автоматом M с начальным состоянием qi . Если автоматные функции Mi и Mj одинаковы, то состояния qi и qj называются эквивалентными или неотличимыми. В противном случае состояния qi и qj называются различимыми. Состояния qi и qj являются k-эквивалентными, если соответствующие им автоматные функции совпадают на словах длины k. Заметим, что k-эквивалентные состояния являются m-эквивалентными для любого m <= k.
Различимые состояния классифицируют по степени различимости: состояния qi и qj являются r-различимыми, если они являются (r - 1)-эквивалентными, но не являются r-эквивалентными. Таким образом, степень различимости пары состояний конечного автомата определяется однозначно. Степенью различимости конечного автомата считается максимум степеней различимости пар его состояний.     Степень различимости играет важную роль в диагностических и установочных экспериментах над последовательностными устройствами, а также при расшифровке конечных автоматов.
Известно ( [1] [3, с. 184] [4, с. 314] [5, с. 17]) следующее Утверждение. Степень различимости конечного автомата не превосходит уменьшенного на единицу числа его состояний. Более того, для любого натурального числа s >= 2 существует имеющий s состояний конечный автомат, степень различимости которого равна s - 1.
При доказательстве этого утверждения использовалось свойство отношений эквивалентности.
Бинарным отношением R на множестве A называется произвольное подмножество декартового произведения A * A (множества всех упорядоченных пар элементов множества A).
Бинарные отношения на множестве A могут иметь следующие свойства: рефлексивность, симметричность, транзитивность. 
Нетрудно проверить, что для любого k отношение k-эквивалентности на множестве состояний конечного автомата является рефлексивным, симметричным и транзитивным. Такие отношения называются отношениями эквивалентности.
Разбиением множества называется множество его непустых попарно не пересекающихся подмножеств такое, что множество является объединением этих подмножеств.
Известно, что любому отношению эквивалентности соответствует разбиение множества, на котором оно определено. Элементы этого разбиения называют классами эквивалентности.
Конечный автомат с s состояниями, имеющий n входных, m выходных символов и F классов 1–эквивалентности, будем называть (n, m, s, F )-автоматом. Заметим, что число классов 1–эквивалентности равно статической функциональности конечного автомата.   
В дальнейшем не будем оговаривать выполнение следующих условий n >= 2, m >= 2, s >= 2, F <= s и F <= mn (статическая функциональность (n, m, s)-автомата не превосходит mn ).
Пусть M SR(n, m, s, F ) - максимальная степень различимости состояний (n, m, s, F )-автоматов.
Справедливо следующее утверждение.  Теорема 1. M SR(n, m, s, F ) = s + 1 - F . 
Доказательство теоремы 1 будет приведено ниже.
Состояние qr конечного автомата, имеющего команду xqj -> yqr , называют x-потомком состояния qj и обозначают qjx .  Лемма 1. Если в автомате есть r-различимые состояния, r >= 2, то при любом t, 1 <= t <= r - 1, в нем имеются t-различимые состояния. 
Доказательство. Пусть (qi , qj ) - пара r-различимых состояний конечного автомата и пусть a1 a2 . . . ar - слово, различающее эту пару. Заметим, что на словах меньшей длины эти состояния неотличимы. Пусть qt,1 = qta1 , пусть qt,2 = qt,1 a2 и т.д. Состояния qi,1 и qj,1 (r - 1)различимы, так как они (r - 2)-эквивалентны и различимы на слове a2 . . . ar длины r - 1.
Индукцией по t, 1 <= t <= r - 1, нетрудно показать, что состояния qi,t и qj,t являются (r - t)-различимыми. Лемма 1 доказана.
Пусть Ek - разбиение множества состояний конечного автомата, соответствующее отношению k-эквивалентности. Если автомат содержит (k + 1)-различимые состояния, то, по крайней мере, один из классов k-эквивалентности перестанет быть классом (k + 1)эквивалентности, т.е. |Ek+1 | > |Ek |.
Пусть автомат M имеет степень различимости, равную r, и пусть |E1 | = F . Из леммы 1 получаем следующую цепочку неравенств |E1 | < |E2 | < . . . < |Er |. Отсюда в случае r > s + 1 - F получаем противоречие с очевидным неравенством |Er | <= s.
Первая часть теоремы 1 доказана.
Докажем вторую часть теоремы 1.
Пусть M 1 - (n, m, s, F )-автомат, у которого не более одного не одноэлементного класса 1-эквивалентности. Состояния автомата M 1 в одноэлементных (не одноэлементных) классах 1-эквивалентности обозначим как p1 , p2 , . . . , pF -1 (как q1 , q2 , . . . , qt , где t = s-F +1). Автомат     M 1 имеет следующий граф переходов. Из вершины qi , 1 <= i <= t - 1, все дуги идут в вершину qi+1 . Из вершины pi , 1 <= i <= N - 2, все дуги идут в вершину pi+1 . Из вершины qt все дуги идут в вершину p1 . Из вершины pF -1 все дуги идут в вершину q1 .
Нетрудно проверить, что состояния q1 и q2 являются (s + 1 - F)различимыми. Вторая часть теоремы 1 доказана.
Замечание. Автомат M 1 выбран из условия простоты описания.
Рассмотрим теперь подмножества множества (n, m, s, F)-автоматов, имеющие одинаковый спектр.
Под (n, m, s, F, D)-автоматом будем понимать (n, m, s, F)-автомат со спектром D.
Вначале докажем достаточное условие на разбиение D, при котором M SR(n, m, s, F, D) = M SR(n, m, s, F ).  Теорема 2. Если не более чем один класс 1–эквивалентности разбиения D имеет мощность большую 2, то M SR(n, m, s, F, D) = M SR(n, m, s, F). 
Доказательство. Пусть разбиение D состоит из a одноэлементных множеств, b двухэлементных множеств и одного множества из c >= 3 элементов (s = a + 2b + c). Для простоты описания рассмотрим случай a >= 2, b >= 2, c >= 2.
Пусть M 2 - автономный (n, m, s, F, D)-автомат и пусть qi1 , 1 <= i <= a, (qj3 , 1 <= j <= c,) - его состояния из одноэлементных множеств (из множества, содержащего более 2 элементов) разбиения D. Пусть
2 , q 2 , 1 <= t <= b, - состояния из двухэлементных множеств разбиения D. Теорема 2 доказана.
Покажем, что условие теоремы 2 не является необходимым.
Для упрощения изложения рассмотрим случай автономных (2, a + b, 2, {a, b})-автоматов, у которых Y = {0, 1}. Пусть qi0 , 1 <= i <= a, (qj1 , 1 <= j <= b) - состояния, в которых реализуется константа 0 (константа 1).  Лемма 2. M SR(2, 2, 8, 2, {3, 5}) = 7. 
Доказательство. Пусть M 3 - (2, 8, 2, {3, 5})-автомат со следующей системой переходов.
Нетрудно проверить, что состояния q31 и q51 являются 7различимыми. 
Покажем зависимость максимальной степени различимости состояний от спектра. Для простоты изложения ограничимся рассмотрением автономных автоматов.
Пусть M SRa(m, s, F ) (Пусть M SRa(m, s, F, D)) - максимальная степень различимости состояний автономных автоматов с F классами 1–эквивалентности (со спектром D), у которых |Y | = m, |Q| = s.  Теорема 3. Существуют спектры D, для которых M SRa(m, s, F, D) 6= M SRa(m, s, F ). 
Доказательство следует из равенства M SRa(2, 9, 2, {3, 6}) = 7. 
Пусть qi0 , 1 <= i <= 3, (qi1 , 1 <= i <= 6) - состояния, в которых реализуется константа 0 (константа 1).
Нижняя оценка. Пусть M 4 - (2, 9, 2, {3, 6})-автомат, отличающийся от автомата M 3 добавлением состояния q61 и команды q61 -> q51 . Нетрудно проверить, что состояния q31 и q51 являются 7-различимыми.
Верхнюю оценку получаем методом перебора. Граф переходов связного автономного автомата имеет один цикл, в вершины которого могут входить деревья. Перебор проводим по длине цикла.
Анализ автоматов, не являющихся связными, сводится к анализу их компонент связности.

Рассматривается оценка одного из параметров конечных автоматов - степень различимости состояний. В работе рассматриваются множества конечных автоматов с произвольными функциями выхода и переходов. Состояния конечного автомата называются r - эквивалентными, если соответствующие им автоматные функции одинаковы на словах длины r. Состояния называются r–различимыми, если они (r–1)-эквивалентны и соответствующие им автоматные функции различаются на словах длины r. Максимальная степень различимости состояний автомата называется его степенью различимости. При отсутствии ограничений известна достижимая верхняя оценка степени различимости равная s-1, где s - число состояний автомата. В каждом своем состоянии конечный автомат реализует функцию, аргументы которой (значения которой) суть элементы входного (выходного) алфавита. Число различных таких функций будем называть статической функциональностью автомата. Рассматриваются автоматы с заданной статической функциональностью. Получена достижимая верхняя оценка степени различимости, равная s + 1 - F , где F - статическая функциональность автомата.  Множество {s1 , s2 , . . . , sF }, где si , 1 <= i <= F, - мощность i-го класса 1-эквивалентности будем называть спектром конечного автомата. Показана зависимость максимальной степени различимости состояний конечного автомата от его спектра.