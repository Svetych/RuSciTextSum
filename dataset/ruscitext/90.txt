ЭФФЕКТИВНЫЕ ДЕСКРИПТОРЫ ДЛЯ ЛОКАЛЬНОГО ОПИСАНИЯ ИЗОБРАЖЕНИЙ 

Введение
Существует большой класс задач, в которых нужно установить взаимно-однозначное соответствие между точками на двух изображениях, полученных путем регистрации одной и той же сцены либо различными камерами, либо одной камерой при изменении ракурса. Такие задачи возникают, например, при обработке результатов аэрофотосъемки, в фотограмметрии, при сшивке панорамных изображений, при построении трехмерной модели сцены по стереопаре и во многих других областях обработки изображений. Точки, между которыми установлено соответствие, обычно называют сопряженными. Как правило, для решения этой задачи на изображении выделяют так называемые особые (или ключевые) точки (в англоязычной литературе interest points или keypoints), и находят соответствие между ними, а для остальных точек соответствие устанавливается путем интерполяции. Это, с одной стороны, позволяет существенно сократить объем вычислений, поскольку число ключевых точек существенно меньше, чем всех точек изображения, а с другой стороны – снизить число неправильно найденных соответствий. Последнее обстоятельство связано с тем, что в качестве особых используются те точки изображения, окрестность которых хорошо различима на обоих изображениях и слабо изменяется при изменении освещения, ракурса и масштаба, например, точки, соответствующие вершинам углов, Т-образным соединениям и т.п.
Для последующего сопоставления точек их окрестность описывается вектором характерных признаков, который называется дескриптором (от англ. descriptor – описатель, признак). К настоящему моменту предложено большое число алгоритмов для вычисления дескрипторов; среди них наиболее эффективными считаются методы SIFT (Scale-Invariant Feature Transform) [1] и SURF (Speed-Up Robust Features) [2]. В обоих методах для достижения инвариантности к изменению масштаба строится пирамида изображений, получаемых из исходного путем последовательного уменьшения разрешения, и анализируются изображения всех уровней пирамиды. В методе SIFT к изображению каждого уровня применяется набор гауссовых фильтров (1) с увеличивающимися в 2 раз значениями sig , начиная с sig = 2 , а затем вычисляются разности смежных полученных изображений. В качестве особых берутся точки, в которых достигается локальный экстремум этих разностей. В методе SURF для каждой точки изображения строится матрица Гессе, элементами которой являются свертка изображения со вторыми производными гауссиана (1) по каждому направлению: (2). В качестве особых выбираются точки, в которых достигается локальный максимум определителя этой матрицы.
В методе SIFT дескрипторы вычисляются следующим образом. Выбирается окно – окрестность особой точки размером 8х8 пикселей, и в каждой точке этой окрестности вычисляется градиент, что позволяет избавиться от небольших изменений освещенности. Далее градиенты умножаются на весовую гауссову функцию с центром в особой точке и значением sig , равным половине размера окна, что позволяет компенсировать небольшие ошибки в определении положения ключевой точки. Далее строится более грубая сетка размером 4х4, и значения градиентов для всех пикселей, попавших в укрупненные ячейки, осредняются. После этого для градиентов строятся гистограммы, соответствующие восьми основным направлениям, полученным поворотом горизонтальной оси на угол pi 4 . В результате получается вектор характерных признаков, состоящий из 4х4х8=128 элементов. Для снижения влияния возможного изменения освещенности этот вектор нормируется таким образом, чтобы он стал единичной длины. После этого локальное изображение в окрестности особой точки поворачивается в направлении, соответствующем максимальному элементу гистограммы – за счет этого достигается инвариантность к повороту, и дескриптор преобразуется путем выполнения соответствующего поворота [1].
В методе SURF для получения дескрипторов применяется аналогичная техника, только вместо вычисления градиентов используется разложение по вейвлетам Хаара, за счет чего достигается ускорение вычислений. На первом шаге алгоритма находится главное направление путем нахождения максимума суммы коэффициентов разложения в пределах круговых секторов размером pi 3 с центром в особой точке. Далее изображение поворачивается в этом направлении, разлагается по вейвлетам и умножается на гауссову весовую функцию. В качестве дескриптора используется вектор, состоящий из суммы коэффициентов разложения в горизонтальном и вертикальном направлениях, а также из суммы модулей этих коэффициентов [2].
В настоящей работе рассматриваются два типа дескрипторов – в полярных и в полярно-логарифмических координатах. Очевидными достоинствами полярных дескрипторов является легкость их вычисления, а также инвариантность относительно поворота. Второй тип дескрипторов основан на применении полярно-логарифмического преобразования, которое поворот изображения и изменение его масштаба в исходных декартовых координатах переводит в параллельный перенос вдоль главных осей в полярно-логарифмических координатах. Если для сопоставления этих дескрипторов находить максимум Фурье-корреляции, то можно добиться инвариантности относительно поворота и изменения масштаба изображений.
Полярные дескрипторы
Пусть особая точка имеет координаты ( x0 , y0 ) . Введем локальные полярные координаты ( r ,fi ) с центром в этой точке, как показано на Рис. 1А, и построим в полярных координатах дискретную сетку. Интерполируем значения интенсивностей изображения в узлы этой сетки. Рассмотрим произвольный узел с координатами в полярной системе ( rk ,fin ) . Найдем такие индексы i и j , при которых одновременно выполняются следующие неравенства (см. Рис. 1Б) и вычислим интерполяционные коэффициенты alpha и beta. С помощью этих коэффициентов можно провести интерполяцию изображения в узлы полярной сетки: (3). Вычислим центральные разностные производные по углу fi : (4). Вычислим суммарную интенсивность абсолютных величин производных вдоль каждого радиуса и найдем максимальное значение величины Sn. И наконец, повернем полярную систему координат таким образом, чтобы нулевое значение угла соответствовало направлению S max . Это обеспечит инвариантность относительно поворота изображения в окрестности особой точки. В качестве дескриптора будем использовать значения разностных производных (4) в повернутой системе координат. 
Полярно-логарифмические дескрипторы
Полярно-логарифмическое (в англоязычной литературе Log-Polar) [3,4] преобразование формально описывается следующими соотношениями: (5). Как видно из формул (5), ( r ,fi ) являются полярными координатами, так что x = r cos fi + x0 , y = r sin fi + y0 , r = b p . Инвариантность полярно-логарифмических преобразований состоит в том, что при повороте изображения (в декартовых координатах) происходит параллельный перенос изображения вдоль оси Ofi (в полярно–логарифмических координатах), а изменение масштаба приводит к параллельному переносу изображения вдоль оси O p . Последнее непосредственно следует из свойств логарифма. На Рис. 2 Б показано, что поворот приводит к сдвигу по оси абсцисс, а изменение масштаба – к сдвигу вдоль оси ординат.
Для построения дескриптора введем равномерные сетки по p и fi в полярно-логарифмических координатах и, как и в описанном выше случае с полярной системой координат, интерполируем изображение I i , j в узлы этой сетки, используя формулу (3). К полученному изображению, которое обозначим как J k ,n , k = 1,…, N p , n = 1,…, Nfi , применим дискретное преобразование Фурье, которое обозначим как F , и в результате получим дескриптор. Этот дескриптор обладает свойствами инвариантности к сдвигу. Действительно, рассмотрим два изображения, одно из которых получено из другого в результате сдвига: (6). После применения к этому выражению преобразования Фурье получим [5]. Таким образом, при смещении изображения меняется только его фазовый спектр. Это позволяет вычислять близость дескрипторов следующим образом. Сначала нужно вычислить нормализованную кросс– спектральную функцию (7), а потом применить к этой функции обратное преобразование Фурье: (8) Схожесть дескрипторов D1 и D2 определяется как величина максимального значения этой функции: (9). Дескрипторы D1 и D2 соответствуют изображениям (6), полученным в результате сдвига. В этом случае максимальное значение величины (8) соответствует положению сдвига ( k0 , n0 ) .
Таким образом, поскольку полярно–логарифмическое преобразование переводит изменение масштаба и поворота изображения в сдвиги относительно полярно-логарифмических координат, а преобразование Фурье инвариантно относительно сдвигов, то описанные дескрипторы обладают инвариантностью к изменению масштаба и повороту изображения, если для их сравнения использовать формулы (7) – (9).
Численный эксперимент
Для проведения численного эксперимента использовались три пары изображений: стереопара с очень большим параллаксом (Рис. 3 А, Б); стереопара, у которой одно изображение повернуто на 100 и уменьшено на 12% (Рис. 3 В, Г) и два последовательных кадра из фильма (Рис. 3 Д, Е). Сравнение проводилось путем использования дескрипторов четырех видов: SIFT, SURF, полярных и полярно логарифмических. Первые два типа дескрипторов были реализованы путем использования графической библиотеки с открытыми кодами OpenCV версии 2.4, для двух других был разработан численный код на алгоритмическом языке C++. Поскольку дескрипторы в методах SIFT и SURF имели 128 элементов, при использовании полярных и полярно-логарифмических дескрипторов сетка по углу содержала 16 точек, а сетка по радиусу – 8 точек, так что дескрипторы также имели по 128 элементов. Для каждого i –го дескриптора Di левого изображения находился наименее отличный от него дескриптор правого изображения D j ; схожесть дескрипторов dij вычислялась по следующим формулам: – для дескрипторов, вычисленных по методам SIFT, SURF и в полярных координатах, и по формуле в полярно-логарифмических координатах. Далее находились минимальное d min и максимальное d max значения величины dij , после чего считалось, что дескрипторы соответствуют одной и той же точке на изображениях, если dij ≤ d min + Sig ( d max − d min ) в полярных координатах и для методов SIFT и SURF, а в полярно-логарифмических координатах – если dij ≥ d max − Sig ( d max − d min ) . Здесь 0 ≤ Sig ≤ 1 - величина порога; чем больше его значение, тем большее число точек попадают в разряд соответствующих друг другу, но при этом также возрастает количество ошибочно отождествленных. Величина порога подбиралась следующим образом: от минимального значения 0.1 он увеличивался до тех пор, пока не появлялась хотя бы одна ошибка в определении сопряженных точек. При обработке указанных изображений значение порога находилось в диапазоне от 0.16 до 0.41. Результаты численного эксперимента приведены в Табл. 2 и Табл. 1. В Табл. 1 находятся относительные затраты процессорного времени для вычисления одного дескриптора по сравнению с методом SIFT, причем в последнем столбце учитывалось также время сравнения двух дескрипторов между собой (поскольку для этого использовалась Фурьекорреляция).
Видно, что метод SURF имеет почти такую же вычислительную скорость, как и SIFT; вычисление полярных дескрипторов происходит на два порядка быстрее, а полярно-логарифмических – на порядок быстрее. В Табл. 2 приведены результаты сравнения рассмотренных методов по количеству найденных сопряженных точек. В первом столбце указан номер пары изображений, в остальных столбцах – относительное количество правильно найденных сопряженных точек по сравнению с числом точек, верно отождествленных методом SIFT. Анализ таблицы позволяет сделать следующие выводы. Метод SIFT несколько превосходит метод SURF. Полярные дескрипторы позволяют получить практически такие же результаты, как и в методе SIFT, и уступают только при обработке повернутого и уменьшенного изображения. Поэтому их использование будет оправдано при решении задач, в которых критической является скорость расчетов, поскольку они существенно проще остальных в вычислительном плане. Полярно-логарифмичекие дескрипторы существенно превосходят все остальные, они позволяют получать почти в три раза больше сопряженных точек за существенно меньшее, почти в десять раз, время. 
Заключение
В настоящей работе рассмотрены дескрипторы в полярных и полярно-логарифмических координатах, и проведено их сравнение с наиболее эффективными к настоящему времени дескрипторами, используемыми в методах SIFT и SURF. Проведенный численный эксперимент показал, что использование полярных дескрипторов позволяет получить практически такие же результаты по количеству верно найденных сопряженных точек, как в методах SIFT и SURF, однако за существенно меньшее время. Дескрипторы в полярно-логарифмических координатах позволяют получить почти в три раза больше сопряженных точек, чем при использовании любого из рассмотренных методов, и в восемь раз быстрее, чем по методам SIFT и SURF, что позволяет сделать вывод о существенно превосходстве этого типа дескрипторов над всеми рассмотренными.

В данной статье рассматривается рассматривается проблема установления соответствия между точками на двух изображениях одной и той же сцены, полученных различными камерами или при изменении ракурса. Обсуждаются методы выделения особых точек на изображениях и последующего вычисления их дескрипторов. В частности, рассматриваются алгоритмы SIFT и SURF, а также два типа дескрипторов – в полярных и полярно-логарифмических координатах. Для полярных дескрипторов описывается процесс вычисления дескриптора с использованием локальных полярных координат. Представлено описание полярно-логарифмического преобразования и методики вычисления дескрипторов с его использованием. Проведен численный эксперимент, включающий использование трех пар изображений с различными характеристиками. Сравнение проводилось между четырьмя видами дескрипторов: SIFT, SURF, полярными и полярно-логарифмическими. Для каждого дескриптора определялось наименее отличное от него соответствие на другом изображении, и оценивалась схожесть дескрипторов по специально разработанным формулам. Результаты эксперимента показали, что метод SURF имеет схожую вычислительную скорость с методом SIFT, в то время как вычисление полярных дескрипторов происходит значительно быстрее. При этом сравнение по количеству найденных сопряженных точек показало, что полярные дескрипторы демонстрируют практически такие же результаты, как SIFT и SURF, а полярно-логарифмические дескрипторы значительно превосходят все остальные в количестве найденных точек за гораздо меньшее время.