Выбор оптимального набора информативных признаков для классификации эмоционального состояния диктора по голосу

1. Обзор информативных признаков 
Важнейшим звеном системы автоматического детектирования эмоций по голосу диктора является выделение оптимального набора информативных признаков, коррелированных с эмоциональными состояниями. Выбор информативных признаков оказывает значительное влияние на эффективность классификации. Условно характеристики речи диктора можно разбить на два основных класса — акустические и лингвистические. В зависимости от решаемой задачи их относительная эффективность может быть различной. В модельных эмоциональных базах, в которых речь дикторов соответствует заранее определенному сценарию, либо в многоязычных корпусах, на первый план выходят акустические параметры, в то время как при работе со спонтанной речью роль лингвистических признаков может оказаться весьма существенной [Schuller et al., 2011].
Из-за нестационарности речевых сигналов во времени для определения их акустических характеристик записи обычно приходится разбивать на небольшие фрагменты, именуемые фреймами. Предполагается, что в их пределах исходный речевой сигнал является квазистационарным. Характеристики речевого сигнала, определенные для каждого фрейма, называются локальными. Однако возможна работа и на уровне интегральных характеристик сигнала. Они определяются путем приложения некоторых статистических функционалов ко всем параметрам, выделенным из сигнала.
Однозначного ответа на вопрос, что лучше подходит для нужд распознавания — локальные или интегральные характеристики, пока нет. Предполагается, что применение интегральных параметров позволяет добиться более высокой точности и скорости классификации. Интегральные характеристики речевого сигнала наиболее эффективны для распознавания состояний, соответствующих различным уровням активации психики. Если же эмоциональные состояния соответствуют примерно одному уровню активности, различаясь, например, по валентности (гнев и радость), то их идентификация посредством анализа интегральных характеристик речевого сигнала окажется затруднена. Кроме этого, недостатками применения интегральных параметров является потеря информации об изменениях речевого сигнала во времени и невозможность применения сложных методов классификации из-за нехватки обучающих векторов. Использование локальных характеристик сигнала позволяет обойти большинство из вышеперечисленных трудностей.
Ранее при разработке систем детектирования эмоционального состояния диктора использовались в основном небольшие наборы информативных признаков (несколько десятков). Однако с течением времени, число выделяемых из звукового сигнала характеристик значительно возросло. Создаваемые на основе опыта экспертов признаки по-прежнему играют важную роль при разработке систем детектирования эмоций, однако все больше внимания уделяется методу «грубой силы» (brute force extracting). При этом число выделяемых информативных признаков достигает нескольких сотен, после чего к ним может быть дополнительно применен иерархичный набор функционалов. При таком подходе важнейшее значение приобретают последующие процедуры выбора оптимального набора характеристик, требуемых для эффективного обучения классификатора.
Акустические характеристики голоса могут быть условно разделены на пять категории [El Ayadi et al., 2011]: просодические (частота основного тона, темп речи и т. д.), динамические (фонетическая функция [А. С. Рылов, 2003]), фонационные (отношение гармоник основного тона к шуму, джиттер, шиммер [M. Farrus et al., 2008], …), спектральные (линейные спектральные частоты, кепстральные коэффициенты линейной шкалы частот, кепстральные коэффициенты мел-шкалы частот, …) и энергетические (отношение мощностей в спектральных полосах, оценка мощности сигнала и другие как правило, основанные на энергетическом операторе Тигера). Каждая группа показателей предназначена для описания отдельных аспектов голоса, и находит свое применение в распознавании эмоциональных состояний.
Выбор эффективных информативных признаков для разделения эмоциональных состояний диктора в значительной степени определяется перечнем детектируемых классов эмоциональной речи: характеристики, основанные на энергетическом операторе Тигера, лучше всего приспособлены для детектирования состояния стресса; для разделения состояний с высоким и низким уровнем возбуждения лучше всего подходят просодические характеристики, такие как частота основного тона и энергия сигнала. Для различения нескольких эмоциональных классов необходимо задействовать спектральные параметры, которые также можно скомбинировать с просодическими характеристиками сигнала. Более точно наиболее эффективный набор информативных признаков может быть определен только на этапе экспериментального исследования.
Перед применением функционалов характеристики нижнего уровня можно подвергнуть фильтрации, трансформациям, можно вычислить их первые и вторые производные. Затем можно применять статистические функционалы, методы аппроксимации кривых, или основанные на специфике человеческого восприятия трансформации. Наиболее популярные статистические функционалы это четыре первых момента (среднее, стандартное отклонение, асимметрия и эксцесс), порядковая статистика (экстремумы и темпоральная информация о них), квартили, диапазоны амплитуд, скорость пересечения нуля, подъем/спад, на-чало/конец и анализ высшего порядка [Schuller et al., 2011]. При помощи методов аппроксимации (как правило, линейной) кривых можно получить коэффициенты регрессии, например, коэффициент наклона и ошибки линейной регрессии.
На основе проведенного анализа существующих подходов классификации психоэмоционального состояния диктора по его речи были исследованы следующие базовые информативные признаки речи:
• просодические: частота основного тона, темп речи;
• динамические: фонетическая функция;
• фонационные: отношение гармоник основного тона к шуму, джиттер, шиммер;
• спектральные: линейные спектральные частоты, кепстральные коэффициенты линейной шкалы частот, кепстральные коэффициенты мел-шкалы частот;
• энергетические: отношение мощностей в спектральных полосах, оценка
мощности сигнала.
С применением к ним следующих функционалов от базовых признаков: статистики высших порядков, первая и вторая производные, поведение кратковременных квантилей, энергетический оператор Тигера. 
2. Выбор наиболее информативных и помехоустойчивых параметров речи 
Число всевозможных информативных признаков, выделяемых из звукового сигнала, может достигать нескольких тысяч. Далеко не все из них эффективны для решения задач распознавания эмоционального состояния, а немалая часть потенциально полезных характеристик оказывается избыточными. Перед построением и обучением классификаторов необходимо провести предварительную процедуру отбора информативных признаков. Конечной целью данного этапа работы является выделение релевантного набора характеристик звукового сигнала и декорреляция пространства информативных признаков.
В ранних работах информативные признаки выбирались эвристическими методами, с опорой на опыт экспертов. С течением времени появилась возможность задействовать для этих целей возросшую вычислительную мощность используемого аппаратного обеспечения.
Алгоритмы отбора информативных признаков, чаще всего используемые при разработке систем распознавания эмоционального состояния по голосу, можно условно разделить на два класса — «обертки» (wrappers) и «фильтры» ( filters).
Отбор признаков с использованием «обертки» (wrapper based selection) использует оценку работы классификатора в качестве критерия оптимизации внутри замкнутого цикла. К сожалению, даже для сравнительно небольших объемов данных исчерпывающий перебор информативных признаков неприемлем. Необходимо выбрать более приемлемую с точки зрения вычислительной сложности, а значит и более ограниченную и менее оптимальную процедуру перебора. Вероятно, на данный момент наиболее популярной является стратегия линейного последовательного поиска (sequential forward search) [Pudil et al., 1994]. Алгоритм начинает с пустого множества и последовательно добавляет к нему наилучшие информативные признаки.
Помимо «оберток», можно использовать «фильтры», к примеру, основанные на методах теории информации либо корреляционном анализе [Hall, 1998]. При этом критерием оптимизации является некоторая функция, соотносящаяся с корреляциями между информативными признаками, приростом информации при их добавлении к набору, определенными метриками в пространстве признаков, статистиками и т. п. Плюсом такого подхода является пониженная, по сравнению с «оберткой», вычислительная сложность алгоритма. В то же время, эффективность работы «фильтра», как правило, ниже, чем «обертки», так как предположения, положенные в его основу, будучи целесообразными в одних случаях, могут существенно нарушаться в других. 
3. Эксперимент 
3.1. Работа алгоритма автоматического выбора оптимального набора информативных признаков 
В результате анализа литературы и предварительно проведенных экспериментов было принято решение использовать в процедуре выбора оптимального набора информативных признаков алгоритм sequential forward feature selection (SFFS). Суть его работы заключается в том, что на каждой итерации к набору добавляется признак, обеспечивающий наилучшую (для данной итерации) эффективность распознавания. 
Мультиклассовый SVM-классификатор строится с использованием библиотеки libSVM1, в которой данная опция реализована посредством набора классификаторов one-vs-one с последующим голосованием. Это позволяет сразу выбрать наиболее оптимальный набор информативных признаков именно для мультиклассовой классификации, не занимаясь подбором параметров для отдельных классов.
В SVM-классификаторе используется RBF-ядро, а в качестве информативных признаков используются расстояния (интеграл модуля разности маргинальных функций распределения) между функциями распределения различных видов наблюдений и соответствующих медианных функций распределения для различных эмоциональных классов.
После подбора очередного информативного признака параметры модели, используемой при обучении классификатора, корректируются для достижения оптимальной эффективности распознавания. 
3.2. Оценка эффективности классификации 
Эффективность распознавания на каждой итерации и в процедуре подбора параметров модели оценивается при помощи метода v-fold cross-validation, реализованного в составе пакета libSVM. Данный метод подразумевает разбиение обучающего множества на v частей, с последующим обучением классификаторов на v-1 части, тестированием на оставшейся части и усреднением полученных результатов.
Итоговая оценка сформированного набора информативных признаков определяется как медианное значение эффективности классификации, достигаемой моделью при случайном разделении исходного множества на обучающую и тестовую выборки. 
3.3. Тестирование алгоритма SFFS на берлинском корпусе эмоциональной речи 
Тестирование алгоритма проводилось на записях, взятых из берлинского корпуса эмоциональной речи (Emo-DB). База включает 535 записей речи 10 дикторов (5 мужчин, 5 женщин), воспроизводящих набор дискретных эмоциональных состояний, называемых иногда «архетипическими» (гнев, раздражение, страх, радость, скука, печаль и нейтральное состояние). 
Авторское исследование 
libSVM — это программный пакет предназначенный для разработки алгоритмов на основе метода опорных векторов; 
Видно, что на каждой итерации эффективность распознавания эмоциональных классов возрастала до тех пор, пока не достигла некоторого максимума. Затем эффективность распознавания возрастала с ростом количества признаков очень медленно (Рис. 1).
Тестирование, полученного в результате работы SFS, набора из 50 информативных признаков и подобранных параметров SVM показало, что эффективность классификации составляет приблизительно 85 % (матрица спутывания приведена в таблице 1). 
4. Анализ и выводы 
Выбор набора наиболее существенных информативных признаков при помощи sequential feature selection, а так же подбор оптимальных параметров модели SVM-классификатора позволил достичь эффективности распознавания эмоциональных состояний на корпусе Emo-DB порядка 85 %, что сравнимо с таковой для человека.
Для достижения указанной эффективности распознавания, согласно графику, приведенному на рисунке 1, достаточно 20 информативных признаков.
В число наиболее эффективных информативных признаков вошли: производная мощности, первая и вторая производные частоты основного тона, MFCC, LPCC и LSF коэффициенты, отношение мощностей в спектральных полосах, а также некоторые функционалы от указанных параметров.
Дальнейшее совершенствование классификатора представляется авторам в использовании динамических моделей эмоциональной речи.

Первая часть рассматривает ключевые аспекты выделения информативных признаков для автоматического детектирования эмоций по голосу диктора. Он подчеркивает важность выбора оптимального набора признаков, связанных с акустическими и лингвистическими характеристиками речи. Делается обзор методов анализа речевых сигналов: с использованием локальных характеристик записи, разбитой на уровне фреймов и записи целиком с использованием интегральных характеристик. Рассматриваются способы выбора наборов информативных признаков, используемых для разработки систем детектирования: метод на основе экспертной оценки и метод с помощью "грубой силы". Обсуждаются различные категории акустических характеристик голоса, каждая из которых играет свою роль в распознавании эмоциональных состояний. Проводится обзор эффективных наборов информативных признаков для разделения эмоциональных состояний диктора. Далее описываются методы, предварительной обработки записи, (такие как фильтрация, вычисление производных), и последующей (применение статистических функционалов и методов аппроксимации кривых). Представлен обзор исследованных базовых информативных признаков речи (просодические, динамические, фонационные, спектральные и энергетические характеристики), а также рассматриваются функционалы, применяемые к ним для улучшения классификации. Во второй части рассматривается выбор наиболее информативных и помехоустойчивых параметров речи для распознавания эмоционального состояния диктора. Отмечается, что перед построением и обучением классификаторов требуется процедура отбора информативных признаков, цель которой – выделить релевантный набор характеристик и уменьшить их корреляцию. Описываются два основных класса алгоритмов отбора признаков: "обертки" (wrappers) и "фильтры" (filters). Рассматриваются достоинства и недостатки, каждого. В третьей части описывается эксперимент, проведенный для выбора оптимальных параметров речи для распознавания эмоционального состояния. В работе используется алгоритм sequential forward feature selection (SFFS). Для оценки эффективности классификации использовался метод v-fold cross-validation. Тестирование алгоритма SFFS проводилось на записях из берлинского корпуса эмоциональной речи (Emo-DB), включающего 535 записей 10 дикторов, воспроизводящих различные эмоциональные состояния. В выводах отмечается, что использование SFFS и подбор оптимальных параметров модели SVM-классификатора позволил достичь высокой эффективности распознавания эмоциональных состояний, сравнимой с человеческой (порядка 85 % распознавания на берлинском корпусе для набора из 20 информативных признаков). Перечислены наиболее эффективные основные информативные признаки. 