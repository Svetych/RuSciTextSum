Распознавание динамики особых точек в видеоряде особых точек

1. Введение
Часто решению задач распознавания предшествует выделение особых точек изображения [1] . Мы не рассматриваем вопрос выделения особых точек, считая их заданными на данном плоском изображении своими координатами. Два плоских изображения будем называть аффинно эквивалентными, если одно из них может быть получено из другого невырожденным аффинным преобразованием. Инварианты аффинных преобразований конечных множеств точек рассматриваются в работе [2].
Через V обозначим следующее множество функций, аргументы которых в общем случае принимают комплексные значения.
Пусть P — множество всех функций, которые могут быть получены из элементов множества V с использованием операций суперпозиции. Вопросы, связанные с реализацией функций в базисах из некоторых непрерывных функций рассматривались в работах [3], [4].
В настоящей работе по числу N , в базисе V строится функция, позволяющая по двум N -точечным плоским изображениям определять их аффинную эквивалентность. Таким образом, результаты работы могут быть использованы для решения задачи отслеживания динамики особых точек изображений при видеосъемке. Подобная задача изучалась в [5]. В упомянутой выпускной работе описывается метод кластеризации особых точек по некоторым спектральным характеристикам и предлагается алгоритм их отслеживания в предположении малых изменений в положении классов на соседних кадрах. В настоящей работе описывается иной метод слежения, использующий геометрические инварианты множеств особых точек. 
2. Постановка задачи
Пусть даны два изображения (кадра) одного объекта, с выделенными на них множествами особых точек — M . Будем считать что оба множества состоят из N точек. Так же будем считать, что координаты особых точек представлены парами действительных чисел, и существует единственное невырожденное аффинное преобразование плоскости, переводящее одно множество особых точек в другое.
Особые точки, отмеченные на обоих множествах, можно записать в виде двух вспомогательных матриц.
В настоящей работе из элементов базиса V по заданным матрицам строится схема, определяющая аффинную эквивалентность двух изображений, и вычисляет матрицу аффинного преобразования и вектора смещения ~b.
Введем дополнительные обозначения. Центром тяжести множества M будем называть величину E(X)· Центр тяжести множества M определяется аналогично.
Матрицей разброса для множества M назовем матрицу C(M ). Очевидно, что матрицы имеют размерность 2×2 и являются симметричными матрицами. Множество M называется невырожденным, если матрица C(M ) имеет ранг 2. 
3. Вспомогательные утверждения
Нам понадобятся следующие утверждения, которые мы приводим без доказательств. Лемма 1. Пусть E(M ) = ~0, и матрица C(M ) имеет одно собственное значение λ кратности 2. Если множество M' получается из M поворотом относительно начала координат, либо отражением относительно некоторой оси, проходящей через начало координат, то C(M ) = C(M' ). Лемма 2. 
4. Алгоритм распознавания аффинной эквивалентности
Шаг 1
Для заданных невырожденных множеств M и M' вычисляем их центры тяжести. Шаг 2
Вычисляем матрицы разброса, а также собственные значения матриц C(M ) и C(M' ) соответственно. Из невырожденности множеств следует, что все собственные значения положительны.
Обозначим через XC (M ) и XC (M' ) матрицы координат особых точек с центрами тяжести в начале координат. Шаг 3
Для найденных собственных значений находим соответствующие нормированные собственные вектора. В силу симметричности матриц C и C' эти собственные вектора будут попарно ортогональны для каждой матрицы.
Находим матрицы поворота (симметрии) R и R' размерности два на два, которые переводят вектора в e~1 = (1, 0)T и e~2 = (0, 1)T . При необходимости изменяется ориентация пар векторов.
Выполнив указанные преобразования, из множеств M и M' получаем множества MR и MR'. Матрицы координат особых точек этих множеств получаем умножая слева матрицы X и X' на матрицы поворота R и R' соответственно. Так же возможен случай, при котором необходимо изменить ориентацию системы координат, а после совершить поворот множества.
Покажем, что после такого поворота (с возможным изменением ориентации системы координат), собственные значения матриц C(MR ) и C(MR' ) будут равны собственным значениям матриц C(M ) и C(M ' ) соответственно, а собственными векторами станут вектора e~1 и e~2 .
Рассмотрим матрицу C(MR ). R — ортогональная невырожденная матрица, то есть, RT = R−1 , получаем что v~1 = RT * e~1 . Аналогично, v~2 = RT * e~2 . Предполагая, что ориентации двух множеств координат совпадают, а так же из того, что C(M ) * v~1 = λ1 * v~1 по определению λ1 , получаем C(MR ) * e~1. То есть, собственное значение не изменилось, а собственным вектором стал вектор e~1 .
Таким же образом получаем C(MR ) * e~2 = λ2 * e~2 .
Для матрицы C(MR' ) рассуждения аналогичны. Шаг 4
Вдоль координатных осей выполняем растяжение или сжатие множеств MR и MR' , полученных после поворота с возможной сменой ориентации координат на предыдущем шаге. Таким же образом получаем, что C(MS ) * e~2 = e~2 .
Для матрицы C(MS' ) рассуждения аналогичны. Шаг 5
После совершения указанных преобразований над множествами M и M ' , мы получаем два множества MS и MS' . Согласно рассуждениям, проведенным на предыдущем шаге, матрицы C(MS ) и C(MS' ) имеют одинаковое собственное значение кратности два и равное единице. 
Ранее в настоящей работе были указаны две вспомогательные леммы. Лемма 1 является необходимым, а лемма 2 — достаточным условиями для совмещения двух множеств поворотом либо осевой симметрией. Полученные множества MS и MS' удовлетворяют условиям доказанных утверждений, из чего делаем вывод, что два этих множества можно совместить, выполнив поворот одного из них, либо преобразование осевой симметрии.
На данном шаге находится такое преобразование, которое совместит два полученных нами множества. В настоящей работе для совмещения двух множеств совершаются всевозможные повороты одного из множеств, на углы, которые вычисляются по всевозможным парам точек. Если два множества аффинно эквивалентны, то один из таких поворотов приведёт к совмещению двух множеств. Данный подход имеет временную сложность O(N 2 ), но может быть эффективно использован при параллельной архитектуре — всякий поворот может быть вычислен независимо от других, а вычисление поворота по одной паре точек имеет временную сложность O(1).
В этом случае очевидным образом можно восстановить взаимно-однозначное соответствие точек двух множеств по тому, какой именно из поворотов либо осевых симметрий укажет на совмещение двух множеств. 
5. Схема
Понятие нелинейной глубины над некоторым базисом функций введено в [6]. В базисе V нелинейными будем считать следующие функции: {ln(x), ex , sqrt(x), sign(x)}. Будем проводить оценку нелинейной глубины схемы. Под сложностью схемы будем понимать число элементов в схеме.
Опишем схему, реализующую приведенный выше алгоритм.
Условно схему можно разбить на 9 блоков. Далее приведем описания этих блоков и оценки их нелинейной глубины и сложности. Блок 1
Определяются центры тяжести каждого множества, начала координат переносятся в центры тяжести.
На входе блока имеется 4 * N действительных значений — пар координат из двух данных множеств M и M ' . На выходе получаются 4 * N действительных значения — новые точки в системах координат, где начала координат совмещены с центрами тяжести множеств.
Сложность блока — O(N ). Нелинейная глубина блока — 0.
Блок 2
Вычисляются коэффициенты матриц разброса для каждого множества. 
На входе блока имеется 4 * N действительных значений — координаты точек, с центрами тяжести в начале координат. На выходе получаются 6 значений — коэффициенты матриц разброса (по 3 в силу симметричности). Сложность блока — O(N ). Нелинейная глубина — 2.
Блок 3
По матрицам разброса каждого множества вычисляются собственные значения.
На входе блока имеется 6 действительных значений — матрицы разброса. На выходе получаются 4 значения — собственные значения матриц разброса. Сложность блока — O(1). Нелинейная глубина — 3.
Блок 4
По матрицам разброса каждого множества а так же их собственным значениям вычисляются собственные вектора.
На входе блока имеется 10 действительных значений — собственные значения матрицы разброса и коэффициенты матриц разброса. На выходе получаются 8 значений — коэффициенты соответствующих собственных векторов. Сложность блока — O(1). Нелинейная глубина — 2.
Блок 5
По координатам собственных векторов матриц разброса для обоих множеств вычисляется матрица поворота (симметрии).
На входе блока имеется 8 действительных значений — собственные вектора матриц разброса.На выходе получаются 8 значений — коэффициенты матрицы поворота. Сложность блока — O(1). Нелинейная глубина — 5.
Блок 6
По заданной матрице поворота и двум множествам точек вычисляются координаты особых точек множеств после применения указанного поворота.
На входе блока имеется 4 * N + 8 действительных значений — координаты точек и матрицы поворота. На выходе получаются 4 * N значений — координаты точек после поворота. Сложность блока — O(N ). Нелинейная глубина — 2.
Блок 7
По двум заданным множествам особых точек и собственным значениям соответствующих матриц разброса вычисляются координаты точек обоих множеств после растяжения и сжатия определённого вида вдоль координатных осей.
На входе блока имеется 4 * N + 4 действительных значений — координаты точек и собственные значения. На выходе получаются 4 * N значений — координаты точек после растяжения или сжатия. Сложность блока — O(N ). Нелинейная глубина — 5.
Блок 8
По двум заданным множествам особых точек совершаются всевозможные преобразования координат, соответствующие поворотам на углы между всякими парами точек двух множеств, в целях совмещения двух изображений.
Так же совершаются аналогичные преобразования над множеством точек, в котором все точки являются отражениями точек исходного множества относительно оси абсцисс. Это соответсвует смене ориентации системы координат.
На входе блока имеется 4 * N действительных значений — координаты точек обоих множеств, которые можно совместить поворотом. На выходе получаются 4 * N 2 + 2 * N значений — всевозможные повороты одного из множеств (включая его отражение относительно оси абсцисс) и второе множество точек. Всевозможные повороты составляются параллельно — следовательно, сложность блока O(N 2 ). 
Для вычисления таких поворотов сначала выбирается пара точек, определяется знак при синусе в матрице поворота, а после вычисляется матрица и производится умножение на неё слева. Нелинейная глубина — 14.
Блок 9
По заданным координатам точек при совершении всевозможных поворотов одного множества относительно другого производится сравнение двух множеств и поиск совмещения.
На входе блока имеется 4 * N 2 +2 * N значений предыдущего блока, на выходе получается одно значение — 1 в случае аффинной эквивалентности множеств и 0 в противном случае. Блок имеет сложность O(N 2 ) и нелинейную глубину 3. Действие блока основано на подсчете числа совпадений точек. Если число совпадений будет равно N то два множества аффинно эквивалентны, и по расположению совпадающих точек на выходах сравнивающей части можно определить взаимно-однозначное соответствие индексов.
В итоге можно получить следующую теорему, доказательство которой проводится конструктивным способом. 
Теорема 1. Для заданного натурального числа N в базисе V можно построить схему с нелинейной глубиной 36, и сложностью O(N 2 ), определяющую аффинную эквивалентность двух N -элементных множеств особых точек, и, в случае их аффинной эквивалентности, идентифицировать точки этих множеств.

По заданному натуральному числу N в базисе из линейных функций, логарифма, экспоненты, функции сигнум и функции извлечения квадратного корня строится схема проверки аффинной эквивалентности двух плоских N -точечных изображений. Нелинейная глубина схем не зависит от N . Таким образом, время обработки изображений полученными схемами не зависит от размера задачи.