Адаптивный метод сегментации гистологических изображений

За последнее десятилетие удалось достичь значительного снижения смертности от колоректального рака. Немалую роль в этом сыграло появление автоматизированных систем сегментации и исследования гистологических изображений, позволяющих в короткие сроки получить точные результаты для большого объема данных.
Целью дипломной работы является проектирование и последующая реализация адаптивного метода сегментации гистологических изображений желез, а также проверка эффективности реализации на наборе реальных данных.
В качестве материала для исследования используются изображения набора данных Warwick-QU . В ней собраны 165 снимков тонких срезов тканей толстой кишки, полученных с помощью микроскопа Zeiss MIRAX MIDI, а также эталонная разметка, подготовленная специалистами для каждого из изображений.
Железистые структуры преимущественно имеют эллипсовидную форму. Границы желез выражено темного цвета, что является основным критерием при их обнаружении.
Для выделения желез на гистологических изображениях был предложен адаптивный алгоритм, состоящий из двух этапов. На начальном этапе на изображение наносится равномерная сетка, после чего в каждый из ее узлов помещается центр шаблона, представляющего из себя круг, равномерно разбитый на кольцевые секторы. По данному шаблону строится граф, состоящий из вершин лежащих на лучах. Каждому из кольцевых секторов соответствует вершина, лежащая на соответствующем сектору луче. Веса вершин вычисляются как среднее значение интенсивности пикселей изображения, лежащих в соответствующем кольцевом секторе:

На следующем шаге в графе ищется замкнутый цикл, имеющий наименьший вес. Данный цикл, перенесенный на шаблон, соответствует предполагаемому прохождению границ желез для данного узла.
Информация от каждого узла суммируется, тем самым формируя карту вероятностей расположения желез. Эта карта используется как карта высот для получения начальной сегментации с помощью алгоритма Watershed .
 
Начальная сегментация строится без учета принадлежности областей к классу желез, поэтому необходимо отсеять неподходящие области. Отсев неподходящих областей происходит на втором этапе.
Каждая из областей начальной сегментации подается на вход обученной нейронной сети, оценивающей вероятность того, что данная область — железа. На основании полученной информации строится окончательная сегментация путем отсева областей, не принадлежащих классу желез.
Нейронная сеть состоит из трех сверточных блоков, а также из двух полносвязных слоев. Два первых сверточных блока служат для выделения признаков на изображении. Третий сверточный блок служит для отсева незначащих признаков. Полносвязные слои используются непосредственно для преобразования полученных признаков в вероятность принадлежности области классу желез. В качестве оптимизатора используется оптимизатор Адама.
Данная архитектура показала наилучшие результаты среди нескольких опробованных в ходе разработки алгоритма архитектур, имеющих в своей основе два или три сверточных блока.
Основная часть алгоритма была реализована на языке программирования python 3.7, нейронная сеть была построена и обучена при помощи фреймворка глубокого обучения Tensorflow. Алгоритм успешно прошел проверку на тестовой части базы и показал свою применимость к реальным изображениям. По результатам тестирования можно утверждать, что точность алгоритма составила в среднем 82.5%, а метрика IoU в среднем составляет 0.66. В дальнейшем планируется тестирование алгоритма на наборе изображений PATH-DT-MSU 
