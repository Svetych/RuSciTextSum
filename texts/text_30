Khnum: быстрая open-source программа для расчета метаболических потоков с использованием 13C-углерода

В биологической клетке происходят тысячи химических реакций, называемых метаболическими потоками. Измерение скоростей потоков помогает понять, чем раковые клетки отличаются от обычных, или как спроектировать бактерию, чтобы она производила лекарство. Мощный метод измерения потоков — 13C-Metabolic Flux Analysis (13С-MFA), он же анализ метаболических потоков с использованием 13C-углерода.
Анализ метаболических потоков с использованием 13C-углерода. Сначала проводят эксперимент. Для этого в клеточную среду добавляют вещества, содержащие тяжелый изотоп 13С. После того как углерод распределится по системе, экспериментатор изолирует некоторые метаболиты и замерит, как именно распределился изотоп.
Из его распределения можно восстановить скорости метаболических потоков. Для этого сначала создают математическую модель распределения атомов углерода при заданных скоростях потоков. После этого решают обратную задачу: подбирают такие значения потоков, при которых предсказанное распределение изотопа совпадает с экспериментальным.
Компьютерная симуляция. По входным данным строится граф, который специальным образом преобразуется, и на его основе генерируется несколько подграфов. По каждому подграфу создается система линейных уравнений. Нахождение решения обратной задачи — это задача регрессии, целевая функция которой вычисляется с помощью решения этих построенных систем линейных уравнений. Целевая функция вычисляется сотни раз для нахождения одного решения, поэтому задача компьютерной симуляции вычислительно сложная. Вопросам эффективности вычислений уже посвящено много теоретических работ и каждый год появляются новые, посвященные отдельным компонентам системы.
С практической точки зрения, для 13C-MFA вычислений уже написано 12 программ. Большинство — неэффективно. Самая быстрая и популярная программа — 13CFLUX2. Она имеет закрытый исходный код, а перед использованием надо отправить авторам все входные данные. Можно запросить бесплатную академическую лицензию, но для коммерческих целей программа платна. Цена обсуждается отдельно, но только лишь стоимость тренингов начинается от 900e.
Khnum. В результате работы была написана эффективная программа Khnum.
Она использует несколько открытых библиотек и имеет ряд особенностей.
—	Открытый исходный код позволяет модифицировать программу под свои цели.
—	Модульная структура позволяет исследователю быстро заменить компонент на экспериментальный, чтобы проверить свои предположения.
—	В программе нет внешних зависимостей: для компиляции достаточно стандартной библиотеки libstd++, gcc и CMake.
Результат работы Khnum совпадает с несколькими другими программами. Исходный код доступен по ссылке https://github.com/SteshinSS/k hnum.
Эффективность. Есть мнение, что программа написана очень эффективно. На одинаковых входных данных аналогичная однопоточная программа OpenFLUX2 произвела расчеты за 35 минут. Khnum управился за 22 секунды в однопоточном режиме и за 4 секунды в многопоточном. Чтобы доказать эффективность надо сравниться с лучшей из существующих программ — 13CFLUX2. Хотя автор запустил процесс получения академической лицензии несколько месяцев назад, разработчики выдали доступ именно в последний день отправки тезисов. К сожалению, автор не успел произвести замеры до отправки, но скорее всего успел к моменту вашего чтения этих строк. Пожалуйста, проверьте результаты по ссылке https://github.com/SteshinSS/thesis_msu/tree/master/compare.
Причина эффективности. Профилирование Khnum показало, что большая часть времени тратится на решение систем линейных уравнений, причем при росте числа неизвестных, именно это время растет быстрее всего. При этом, способ решения MFA-систем почти не изучался в литературе.
В работе доказывается Теорема. Все матрицы коэффициентов MFA-систем лежат в классе Мматриц.
Один из базовых методов решения СЛАУ — LU-разложение. Но оно не подходит для разреженных матриц, потому что разложение занимает много памяти. В ответ на это в 1977 году J. Meijerink и H. Vorst предложили специальное ILU-разложение и доказали, что оно существует и устойчиво для любых М-матриц.
В текущей работе проведено сравнение нескольких численных методов для решения MFA-систем. Показано, что стабилизированный метод бисопряженных градиентов с ILU-разложением в качестве предобуславливателя работает быстрее всего.
