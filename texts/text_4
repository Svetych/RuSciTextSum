Метод автоматического анализа минерального состава руд по фотографиям аншлифов

Анализ минерального состава руд и вмещающих пород – важная задача рудной геологии. Он используется в автоматизации разработки способов обогащения и в геолого-поисковых работах для выявления промышленного типа месторождения. На данный момент единственным доступным способом изучения минерального состава является оптический, то есть исследование подготовленных шлифов и аншлифов под микроскопом. Аншлиф представляет из себя небольшой каменный образец руды или рудного прожилка, отполированный до зеркального блеска с одной стороны.
В данной работе разработан и программно реализован алгоритм, позволяющий проводить сегментацию (сопоставление каждому пикслею изображения метки соответствующего класса) с целью определения минерального состава аншлифа . Проведилась сегментация классов пирит (Py), сфалерит (Sh), галенит (Gl), остальные классы и неразмеченные области объединены в один класс — фон (Background).
Существующие алгоритмы диагностики минералов основываются на статистическом анализе изображений . В данной работе используется метод сегментации изображений аншлифов, основанный на применении сверточных нейронных сетей. В качестве нейросетевой модели для осуществления сегментации изображений используется сверточная нейронная сеть U-Net , модифицированная так, чтобы она могла работать с меньшим количеством обучающих данных и делала более точную сегментацию.
В качестве набора для обучения и тестирования используются изображения, предоставленные кафедрой геологии, геохимии и экономики полезных ископаемых геологического факультета МГУ. В работе используется искуственное расширение данных — аугментация.
Данная задача характерна несбалансированностью исходных данных, так как процентное соотношение минералов составляет: Background 33.7%, Sh 29.3%, Py 30.2%, Gl 6.7%.
Ввиду того, что на каждом шаге в нейронную сеть подается набор из случайно вырезанных блоков (патчей), число пикселей наиболее редких минералов может составлять менее 3% от общего числа пикселей. Такая несбалансированность приведет к тому, что нейронная сеть будет хуже предсказывать наиболее редкие минералы.
В данной ВКР был разработан алгоритм, позволяющий уравнять количество пикселей для каждого класса, среди данных, поступающих на вход нейросети.
 
Основная идея заключается в том, чтобы выбирать блок не произвольным образом, а так, чтобы процентное соотношение пикселей каждого минерала было сбалансированно. Для этого на каждом изображении строится карта вероятностей выбора патча для каждого класса. «Горячие» области на этой карте показывают те зоны, при выборе левого верхнего угла патча в которых, получится захватить наибольшее количество пикслей данного класса. Алгоритм балансировки состоит из трех шагов:
1.	Строится карта расстояний до каждого класса при помощи Distance Transform .
2.	По полученной карте расстояний строится интегральное изображение .
3.	При помощи интегрального изображения вычисляется сумма значений в каждой прямоугольной области и нормируется.
В результате использования разработанного алгоритма удалось добиться равного соотношения пикселей для каждого из классов (по 25%) на каждый среди данных, подающихся на вход нейросети.
Метод реализован на языке Python 3 с использованием фреймворка Tensorflow. Средний процент правильной сегментации на тестовых изображениях составил 92.4%, а среднее значение меры IoU по тестовой выборке составляет 0.76.
Работа проводилась в сотрудничестве с геологическим факультетом МГУ. Реализованный метод сегментации может быть использован для анализа минерального состава руд по фотографиям аншлифов.
