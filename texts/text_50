Методы и программные инструменты генерации аккомпанемента к нотным записям

В современном мире компьютеры используются для работы с самыми разными задачами и данными. Одним из наиболее сложных, на данный момент, направлений развития алгоритмов является работа с данными, требующими творческого подхода, в частности с различными видами искусства. Разработка методов и алгоритмов работы с цифровыми данными является востребованной и в музыкальной области. В работе рассматривается подход к решению задачи генерации аккомпанемента музыкальных произведений в заданном стиле. Теория музыки определяет набор правил и критериев, которым в целом должен удовлетворять аккомпанемент, однако они задают лишь общие его черты, и многие из них могут намеренно искажаться композитором. Таким образом, составление аккомпанемента является творческим процессом, для которого нет четкого алгоритма. В работе предложен подход, использующий методы машинного обучения. Нейронные сети позволяют имитировать процесс обучения человека, что дает им возможность распознавать сложные закономерности, которые человек обычно видит интуитивно и от которых зависит природа творчества.
Существует множество работ по генерации музыки при помощи нейронных сетей и схожих методов . Были изучены и реализованы CNN-сеть и LSTM-сеть. Первая оказалась применима для анализа структуры музыкального произведения, но не применима для ее генерации. Тогда как LSTM-сеть, хорошо работающая с временными последовательностями, оказалось применима и для генерации музыки. Был подобран подходящий для удобной работы с LSTM-сетью векторный формат машинного представления нот.
В качестве обучающего блока использован предоставляемый компанией Google корпус Bach dataset . Данный корпус содержит более 21 миллиона размеченных музыкальных отрывков в стиле Баха. Каждый отрывок состоит из четырех одноголосных партий. Первая партия считается входной мелодией, остальные — аккомпанементом. Обучение производилось на облачной платформе Google, предоставляющей возможность обучать сети на основе Tensorflow и Keras с аппаратным ускорением.
Обучение сети проводилось с различными параметрами: подбирался оптимальный размер блоков, размерность векторов внутреннего представления, количество эпох обучения, скорость обучения, детали строения сети. Наилучшие результаты были получены при количестве эпох того же порядка, что и количество элементов в блоке. Успешность сети оценивалась процентом нот аккомпанемента, которые она корректно предсказывала в существующих произведениях, не входящих в тренировочный блок. Для метрики с анализом частоты появления аккордов была получена точность от 75–90%, что позволило не только сгенерировать аккомпанемент, но и лучше отличать обученные, но плохие сети от действительно подходящих.