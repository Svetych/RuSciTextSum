Разработка и исследование метода предотвращения атак распределённого отказа в обслуживании на контроллер в программно-конфигурируемых сетях на основе оценки поведения хостов

Одной из серьезнейших угроз безопасности для программно-конфигурируемых сетей (ПКС) является DDoS атака на контроллер . Инициатором DDoS атаки выступает злоумышленник, имеющий точки присутствия в ПКС сети в виде зараженных хостов с установленным на них специальным вредоносным программным обеспечением (ВПО). ВПО позволяет злоумышленнику удаленно инициировать большое количество новых потоков (фиктивных потоков) трафика в сети. Отсутствие соответствующих правил в таблицах потоков коммутаторов для них приводит к формированию запросов к ПКС контроллеру на их установление. Это влечет за собой существенный рост задержек на установление правил для легитимных пользовательских потоков, истощение вычислительных ресурсов и перегрузку сервера контроллера, нарушение работоспособности всей сети с соответствующими прерываниями и отказами в работе пользовательских сетевых сервисов. Поэтому задача своевременного обнаружения, предотвращения и устранения последствий DDoS атаки на контроллер является актуальной и важной задачей, без решения которой внедрение технологий ПКС в реальных сетях невозможно.
В работе предполагается, что топология сети может динамически изменяться (смена IP адресов хостов, подключение/отключение/миграция хостов, временное отключение коммутаторов); контроллер управляет коммутаторами посредством протокола OpenFlow не ниже версии 1.3 ; мощность DDoS атаки может изменяться посредством изменения частоты отправки пакетов с зараженных хостов или включения/отключения вредоносной активности зараженных хостов. Необходимо найти множество зараженных хостов, сформировать правила для приостановки и устранения последствий DDoS атаки.
Предлагаемый метод основан на двухэтапной фильтрации потоков трафика на граничных коммутаторах доступа пользователей к сети и на контроллере с целью выявления зараженных хостов.
Для учета возможности динамического изменения топологии сети метод производит мониторинг состояния сети, сохраняя информацию о хостах в «таблице соответствия хостов коммутаторам». В таблицах потоков граничных коммутаторов устанавливаются правила для первого этапа фильтрации: пакеты сбрасываются, если их MAC и IP адреса источника, входной порт и/или MAC адрес коммутатора не совпадают или отсутствуют в «таблице соответствия». Каждому граничному коммутатору присваивается пороговое значение количества запросов на установление новых потоков (Packet-In). DDoS атака фиксируется при одновременном превышении установленного порога для какого-либо коммутатора и порогового значения для общего количества Packet-In в сети. После фиксации атаки для каждого хоста рассчитывается оценка поведения хоста, как частное среднего количества пакетов на поток и количества Packet-In с данного хоста. По значению оценки хост классифицируется к одному из введенных типов — пользовательский, зараженный или неопределенный. Для зараженных хостов устанавливаются правила второго этапа фильтрации (правила для сброса пакетов). В качестве устранения последствий DDoS освобождаются таблицы потоков коммутаторов, занятых правилами для фиктивных потоков. Также на основе мониторинга поведения зараженных хостов может быть принято решение о переводе определенных хостов из множества зараженных во множество пользовательских за счет удаления правил фильтрации для них.
Метод, разработанный в дипломной работе, был реализован в виде приложения на языке C++ для контроллера RUNOS 2.0 . В результате экспериментального исследования качества работы метода показано, что использование метода позволяет во время атаки уменьшить задержку обработки запросов на установление нового потока до 73–91%, увеличить доступную пропускную способность каналов до 12%, уменьшить утилизацию CPU контроллера на 55% и минимизировать ошибки 1-го (0,184) и 2-го рода (0,166). Недостатком является возможность увеличения утилизации CPU контроллера в отсутствии атаки на 6%. Исследование стабильности работы метода для различных профилей активности зараженных хостов показало, что стабильнее всего метод работает против «синусоидального» профиля мощности DDoS атаки и при одновременном старте зараженных хостов; ошибка 2-го рода может увеличиться при постепенном или попеременном включении зараженных хостов. Исследование эффективности работы метода проводилось на топологиях с различными характеристиками. Выявлена одинаковая эффективность метода для различной частоты миграции, отключения и подключения новых хостов; ошибки могут возрасти при увеличении частоты смены IP адресов хостов и увеличении доли одновременно отключающихся коммутаторов.
